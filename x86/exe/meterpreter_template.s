; Compile with mingw
; i686-w64-mingw32-gcc meterpreter_template.s -o meterpreter_template.exe -nostdlib -lkernel32 -Wall -Wextra -ffreestanding 
; windows_implant_templates/x86/exe/meterpreter_template.s: Assembler messages:
; windows_implant_templates/x86/exe/meterpreter_template.s:341: Warning: indirect jmp without `*'
;
;


.section .data

.globl _code
_code:

xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx

xorl %eax,%eax
pushl $_ExitProcess@4
pushl %fs:(%eax)
movl %esp,%fs:(%eax)

.ascii "PAYLOAD:\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314\314"

xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx
xorl %ecx,%ecx

.text
.globl _WinMain@16
	.def	_WinMain@16;	.scl	2;	.type	32;	.endef
_WinMain@16:

movl $_code,%eax
jmp %eax
